\chapter{Files Required to Run Cassandra}
\label{ch:input_files}

\section{Simulation Input File} \label{sec:Input_File}
This is a required file that is given as an argument to the Cassandra executable.
Example input files for each ensemble are provided in the Examples directory that can be
modified for new simulations.
%Alternatively, input files can be generated using the graphical user interface as
%explained in section \ref{sec:GUI}.
The input file is divided into sections.
Each section begins with a section header that starts with a '\#',
e.g. {\tt\# Run\_Name}, and ends with a blank line.
Section {\tt\# Move\_Probability\_Info} is an exception and terminates with
{\tt\# Done\_Move\_Probability\_Info}, because subsections
e.g. {\tt\# Prob\_Translation} are separated by blank lines.
Comment lines begin with `!' and are ignored.
Sections in the input file can be listed in any order,
but the order and format of keywords and parameters given in each section
are important unless otherwise noted below.
Previously, some keywords were capitalized, e.g. {\tt CUBIC},
some contained an initial capital, e.g. {\tt Units},
and some were all lowercase, e.g. {\tt kappa\_ins}.
New in version 1.2, all keywords are supported in lowercase text;
each word in a section header must still begin with an initial capital.
%
%%%%%%%%%%%%%%%%
%
% # Run_Name
%
%%%%%%%%%%%%%%%%
\subsection{Run Name}\label{sec:Run_Name}
{\bf \# Run\_Name}\\
{\it Character} \\ \\
%
The run name is specified on the next line following the keyword. This name is used as a prefix for all the files
produced by the simulation. For example,\\ \\
%
{\tt{
\# Run\_Name \\
dee.out
}} \\ \\
%
Cassandra will then use \texttt{dee.out} as prefix for all output files created.

%
%%%%%%%%%%%%%%%%
%
% # Sim_Type
%
%%%%%%%%%%%%%%%%
\subsection{Simulation Type}\label{sec:Sim_Type}

{\bf \# Sim\_Type} \\
{\it Character} \\ \\
%
Sets the ensemble (and thus the suite of moves) of a Cassandra simulation.
The following ensembles are supported: \\
\begin{itemize}
\item nvt or nvt\_mc (canonical ensemble)
\item npt or npt\_mc (isothermal-isobaric ensemble)
\item gcmc (grand canonical ensemble)
\item gemc (Gibbs ensemble)
\item gemc\_npt (Multi-species Gibbs ensemble)
\item nvt\_min (canonical ensemble, only moves which lower the energy are accepted)
\item fragment or nvt\_mc\_fragment (canonical ensemble simulation of a fragment)
\item ring\_fragment or nvt\_mc\_ring\_fragment (canonical ensemble simulation of a ring fragment)
\end{itemize}
Simulation types {\tt fragment} and  {\tt ring\_fragment} are
used only for generating a fragment library.
For example, \\ \\
\texttt{
\# Sim\_Type \\
npt \\ \\
}
%
will run a Monte Carlo simulation in the isothermal-isobaric ensemble in which the number of
molecules of each species $N$, the pressure $P$ and temperature $T$ are held constant.
%
%%%%%%%%%%%%%%%%
%
% # Nbr_Species
%
%%%%%%%%%%%%%%%%
\subsection{Number of species}\label{sec:Nbr_Species}
{\bf \# Nbr\_Species} \\
{\it Integer} \\ \\
%
Total number of species in the simulation. For ionic systems, each ion
is counted as a separate species. For example, for a mixture of two
species, use the following: \\  \\
%
\texttt{
\# Nbr\_Species \\
2
}
%
%%%%%%%%%%%%%%%%
%
% # VDW_Style
%
%%%%%%%%%%%%%%%%
\subsection{VDW Style}\label{sec:VDW_Style}
{\bf \# VDW\_Style} \\
{\it Character(i,1)} [{\it Character(i,2) Real(i,3) Real(i,4)/Logical(i,4)}] \\ \\
%
This keyword specifies the functional form of repulsion dispersion
interactions to be used and if tail corrections are added for box $i$.
One line is required for each box.
{\it Character(i,1)} specifies the van der Waals model and can be
\texttt{lj} for a Lennard-Jones 12-6 potential,
\texttt{mie} for a Mie potential,
or \texttt{none} to turn off all repulsion-dispersion interactions.
{\it Character(i,2)} and {\it Real(i,3)} are required for \texttt{lj} or \texttt{mie}.
{\it Character(i,2)} specifies how the Lennard-Jones potential is truncated.
Options are \texttt{cut}, \texttt{cut\_tail}, \texttt{cut\_switch}, or \texttt{cut\_shift}.
Refer to Chapter~\ref{Chapter:Force Field} for the functional forms.
The other parameters \emph{Real(i,3)} and \emph{Real(i,4)/Logical(i,4)} depend on the
selection of \emph{Character(i,2)} as described below:
%
\begin{itemize}
\item \textbf{cut}: This option cuts the  potential at the distance
specified by \emph{Real(i,3)}. The fourth parameter is omitted. \\ \\
%
For example, to simulate one box with a 14 \AA\ cutoff specify the following:
\\ \\
\texttt{
\# VDW\_Style \\
lj cut 14.0 } \\ \\
%
Similarly, for a two box simulations such as used in the Gibbs
ensemble where both boxes have a 14 \AA\ cutoff, use the
following: \\ \\
\texttt{
\# VDW\_Style \\
lj cut 14.0 \\
lj cut 14.0 } \\ \\
%
\item \textbf{cut\_tail}: This options cuts the potential off at a distance
corresponding to \emph{Real(i,3)} and applies analytic tail
corrections to the energy and pressure. An optional fourth argument
\emph{Logical(i,4)} can be set
to 'true', in which case \emph{Real(i,3)} is ignored and the cutoff
distance is always set to half of the simulation box length. The
cutoff will change during the course of the simulation when attempting
volume moves.  This option is provided to enable reproduction of
literature simulations that use a cut off distance of half the
simulation box length, but its use is discouraged. \\ \\
%
For example, to simulate one box with a 14 \AA\ cutoff using tail
corrections, specify the following:
\\ \\
\texttt{
\# VDW\_Style \\
lj cut\_tail 14.0 } \\ \\
%
For a two box simulation where the first box has a 14 \AA\ cutoff and
the second one has a 20 \AA\ cutoff, use the
following:
\\ \\
\texttt{
\# VDW\_Style \\
lj cut\_tail 14.0 \\
lj cut\_tail 20.0 } \\ \\
%
\item \textbf{cut\_switch}: This option cuts the potential off and smoothly
brings the potential to zero using a spline. The potential is cutoff
and the spline turned on at a distance specified by \emph{Real(i,3)}
(r$_{on}$ in Eq~\ref{Eq:cut_switch}) and the potential goes
to zero at a distance specified by \emph{Real(i,4)} (r$_{off}$ in
Eq~\ref{Eq:cut_switch}). \\ \\
%
For example, a one box simulation using the cut\_switch option could be
specified as follows:
\\ \\
\texttt{
\# VDW\_Style \\
lj cut\_switch 12.0 14.0} \\ \\
%
In this case, the Lennard-Jones potential would end at 12.0 \AA\ and
be smoothly taken to zero at 14.0 \AA. $r_{on} < r_{off}$ or \emph{Real(i,3)} $<$ \emph{Real(i,4)}.
%
\\ \\
\item \textbf{cut\_shift}: This option cuts the potential off at a distance
specified by \emph{Real(i,3)} and shifts the entire potential so that
at this distance the potential is zero. The fourth parameter
\emph{Real(i,4)/Logical(i,4)} is omitted. The functional form of this
potential is given in eq~\ref{Eq:cut_shift}. \\ \\
%
To perform a two box simulation with a cut\_shift option in which both
boxes have a 10.5 \AA\ cutoff, use the following:
\\ \\
\texttt{
\# VDW\_Style \\
lj cut\_shift 10.5 \\
lj cut\_shift 10.5 } \\ \\
%
\\ \\
\item \textbf{cut\_shift-force}: This option cuts the potential off at a distance
specified by \emph{Real(i,3)}. The derivative of the potential is shifted
to zero at the cutoff. The result is that both the potential and derivative
of the potential smoothly go to zero at the cutoff. The fourth
parameter \emph{Real(i,4)/Logical(i,4)} is omitted. The functional
form of this potential is given in eq~\ref{Eq:shift-force}. \\ \\
To perform a two box simulation with a cut\_shift-force option in which both
boxes have a 10.5 \AA\ cutoff, use the following:
\\ \\
\texttt{
\# VDW\_Style \\
lj cut\_shift-force 10.5 \\
lj cut\_shift-force 10.5 } \\ \\
%
\end{itemize}
{\bf Note: For all options, cutoff distances must be less than or
  equal to the shortest edge length of a simulation box}.
%%%%%%%%%%%%%%%%
%
% # Charge_Style
%
%%%%%%%%%%%%%%%%
\subsection{Charge Style}\label{sec:Charge_Style}
{\bf \# Charge\_Style} \\
{\it Character(i,1)} [{\it Character(i,2) Real(i,3) Real(i,4)}] \\ \\
%
Cassandra allows the use of fixed partial charges on atomic centers
using a Coulomb potential of the form given in Eq~\ref{Eq:Coulomb}.
If this section is missing from the input file,
the electrostatic energy of the simulation will not be computed.
If you do not wish to use a Coulomb potential for box {\em i},
set {\it Character(i,1)} to \texttt{none}. If \texttt{none} is
selected for {\it Character(i,1)} then {\it Character(i,2)},
{\it  Real(i,3)} and {\it Real(i,4)} are omitted.
\\ \\
For example, \\ \\
\texttt{
\# Charge\_Style \\
none}
\\ \\
should be used if you have no partial charges and are simulating a single box
(or the section can just be omitted).

To compute the electrostatic energy for box {\em i},
this section must be included and {\it Character(i,1)} set to \texttt{coul}.
For this option,
{\it Character(i,2)} can be set to \texttt{ewald} if you want to use
an Ewald sum to compute Coulombic interactions, \texttt{dsf} if you want to use
the Damped Shifted Force method by Fennell \textit{et al.}\cite{Fennell:2006}, or it can be set to
\texttt{cut}, in which case the Coulombic interactions will be cut off and
the long range interactions ignored. For the Ewald option,
{\it Real(i,3)} is the real space cutoff distance and {\it Real(i,4)}
specifies the accuracy of the Ewald summation. A reasonable value for
the accuracy is 10$^{-5}$. Note that the number of reciprocal vectors
for the Ewald summation is determined in the code based on the
accuracy parameter. For more details, see the paper by Fincham
\cite{Fincham:1994}.\\ \\
%
For example,
\\ \\
\texttt{
\# Charge\_Style \\
coul ewald 12.0 1E-5}\\ \\
will use the Ewald sum for a single box. The real space cutoff will be
12 \AA\ and the accuracy will be $10^{-5}$. If you have two boxes,
like in a Gibbs ensemble calculation, then you could use the
following:
\\ \\
\texttt{
\# Charge\_Style \\
coul ewald 12.0 1E-5\\
coul ewald 30.0 1E-5}
\\ \\
This will use an Ewald sum for both boxes. In the first box, the real
space cutoff will be 12 \AA\ while in the second box a larger cutoff
of 30 \AA\ will be used. {\bf Note: When performing Gibbs ensemble
simulations of vapor-liquid equilibria, the vapor box is often much
larger than the liquid box. In this case, you will want to use a
longer real space cutoff for the larger vapor box to avoid using too
many reciprocal space vectors.} Also note that the real space
cutoffs must always be less than or equal to half of the shortest edge
length of a simulation box. \\

If you wish to use the Damped Shifted Force method, the entry {\it Real(i,3)}
is the electrostatic energy cutoff distance and {\it Real(i,4)} is an optional
entry to specify the damping parameter. If not specified, Cassandra will
set this value algorithmically from the cutoff radius. For example,
\\ \\
\texttt{
\# Charge\_Style \\
coul dsf 12.0 0.20}\\

will use the Damped Shifted Force method for a single box. The electrostatic
energy cutoff will be set to 12 \AA\ and the damping parameter will be set
to 0.20, which is a reasonable value for
typical liquid phase simulations. \\  \\
%
{\bf{Note}}: If the cutoff in VDW\_Style is set to half of the
simulation box length, any cutoff distance specified in the
Charge\_Style section will default to the half of the simulation box
length. In the case of Ewald summation, however, the accuracy will be
the same as {\it Real(i,4)}.
%
%%%%%%%%%%%%%%%%
%
% # Mixing_Rule
%
%%%%%%%%%%%%%%%%
\subsection{Mixing Rule}\label{Mixing_Rule}
{\bf \# Mixing\_Rule} \\
{\it Character} \\ \\
%
Sets the method by which van der Waals interactions between unlike atoms are calculated.
Acceptable options are \texttt{lb} for Lorentz-Berthelot,
\texttt{geometric} for geometric mixing rule
and \texttt{custom} for allowing the user to provide specific values.
To use either \texttt{lb} or \texttt{geometric} keywords with the Mie potential,
all atomtypes must have the same repulsive and dispersive exponents.
If this section is missing, \texttt{lb} is used as default. \\

To illustrate the use of the \texttt{custom} option, consider a mixture of methane (species 1)
and butane (species 2) united atom models using a Lennard-Jones potential.
Methane has a single atomtype, CH4.
Butane has two atomtypes: pseudoatoms 1 and 4 are type CH3, pseudoatoms 2 and 3 are type CH2.
The cross interaction table is as follows:

\texttt{
{\bf \# Mixing\_Rule} \\
custom\\
CH4  CH3  120.49   3.75\\
CH4  CH2   82.51   3.83\\
CH3  CH2   67.14   3.85\\
}
\\ \\
The order in which atom types are listed is unimportant,
but the atom types must match exactly the types given in each MCF.
The Lennard-Jones potential requires two parameters:
an energy parameter with units K, and a collision diameter with units \AA.
The Mie potential requires four parameters:
an energy parameter with units K, a collision diameter with units \AA,
a repulsive exponent, and a dispersive exponent.

%%%%%%%%%%%%%%%%
%
% # Seed_Info
%
%%%%%%%%%%%%%%%%
\subsection{Starting Seed}\label{sec:Seed_Info}
{\bf \# Seed\_Info} \\
{\it Integer(1) Integer(2)} \\ \\
%
Inputs for the starting random number seeds for the simulation.
Cassandra uses a random  number generator proposed by L'Ecuyer \cite{random_gen:1999},
which takes five seeds to calculate a random number,
out of which three are defined internally while two {\it Integer(1)} and
{\it Integer(2)} are supplied by the user.
{\bf When a `checkpoint' file is used to restart a
simulation (see \# Start\_Type below), the user supplied seeds will be
overwritten by those present in the checkpoint file.
If \# Start\_Type is set to `read\_config',
then the seeds specified in the input file are used}.  \\ \\
As an example, \\ \\
\texttt{
\# Seed\_Info \\
1244432 8263662
} \\ \\
is an acceptable way of specifying the seeds.
Note that two independent simulations can be run using the same input
information if different seeds are used.
If two simulations having exactly the same input
information and the same seeds are run, the results will be identical.
%
%%%%%%%%%%%%%%%%
%
% # Rcutoff_Low
%
%%%%%%%%%%%%%%%%
\subsection{Minimum Cutoff}\label{sec:Rcutoff_Low}
{\bf \# Rcutoff\_Low} \\
{\it Real} \\ \\
%
Sets the minimum allowable distance in \AA\ between two atoms.
Any MC move bringing two sites closer than this distance will be immediately rejected.
It avoids numerical
problems associated with random moves that happen to place atoms very
close to one another such that they will have unphysically strong repulsion or
attraction. This distance must be less than the intramolecular
distance of all atoms in a species which are not bonded to one
another. For models that use dummy sites without explicitly defining
bonds between dummy and atomic sites of the molecules (for example,
the TIP4P water model), it is important that the minimum distance is set to be less
than the shortest distance between any two sites on the molecule. For
most systems, 1 \AA\ seems to work OK, but for models with dummy
sites, a shorter value may be required.
%%%%%%%%%%%%%%%%
%
% Pair_Energy
%
%%%%%%%%%%%%%%%%
\subsection{Pair Energy Storage}\label{sec:Pair_Energy}
{\bf \# Pair\_Energy} \\
{\it Logical} \\ \\
%
Cassandra can use a time saving feature in which the energies between
molecules are stored and used during energy evaluations after a move,
thereby saving a loop over all molecules.
This requires more memory, but it can be faster.
The default is to not use this feature.
If you wish to use this, set {\it Logical} to `true'.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% State point related information
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%
%
% Molecule_Files
%
%%%%%%%%%%%%%%%%
\subsection{Molecule Files}\label{sec:Molecule_Files}
{\bf \# Molecule\_Files} \\
{\it Character(i,1) Integer(i,2)}  \\ \\
%
This specifies the name of the molecular connectivity file (MCF) and
the maximum total number of molecules of a given species specified by this MCF.
A separate line is required for each species present in the simulation.
{\it Character(i,1)} is the name of the MCF for species {\it i}.
{\it Integer(i,2)} is the maximum number of molecules expected for the species.  \\ \\
%{\it Integer(i,3)} is
%optional argument that is required in a CFC simulation and indicates
%number of fractional particles of the species in the simulation. For
%example, in a Gibbs ensemble simulation for phase equilibria, there
%will be two fractional particles. \\ \\
For example \\ \\
\texttt{
\# Molecule\_Files \\
butane.mcf 100 \\
hexane.mcf 20\\
octane.mcf 5} \\ \\
specifies that there are three different species, and the MCFs
state the names of the files where information on the three species
can be found.
Species 1 is butane, species 2 is hexane and species 3 is octane.
There can be a maximum of 100 butane molecules, 20 hexane molecules
and 5 octane molecules in the total system.
The maximum
number of molecules specified here will be used to allocate memory for
each species, so do not use larger numbers than are needed.
%%%%%%%%%%%%%%%%
%
% # Box Info
%
%%%%%%%%%%%%%%%%
\subsection{Simulation Box}\label{sec:Box_Info}
{\bf \# Box\_Info} \\
{\it Integer(1)} \\
{\it Character(i)}  \\
{\it Real(i,1)} [{\it Real(i,2) Real(i,3)}] \\
{[}{\tt restricted\_insertion} {\it Character(1) Real(1) [Real(2)]}] \\ \\
This section sets parameters for the simulation boxes.
{\it Integer(1)} specifies the total number of boxes in the simulation.
Gibbs ensemble simulations must have two boxes.
{\it Character(i)} is the shape of the $i$th simulation box.
The supported keywords are \texttt{cubic}, \texttt{orthogonal}, and \texttt{cell\_matrix}. \\ \\
%
If {\it Character(i)} is \texttt{cubic}, \emph{Real(i,1)} is the length of the box edges in \AA.
Information for additional boxes is provided in an analogous fashion
and is separated from the previous box by a blank line.
For a two box simulation, box information is given as: \\ \\
%
\texttt{
\# Box\_Info \\
 2 \\
 cubic \\
 30.0  \\
 \\
 cubic \\
 60.0} \\ \\
%
This will construct a 30 x 30 x 30 \AA\ cube and the second a 60 x 60 x 60 \AA\ cube.

The options orthogonal and cell\_matrix are only supported for constant volume simulations
(i.e. NVT or GCMC) which only have 1 box.
If {\it Character(1)} is \texttt{orthogonal}, \emph{Real(1,1) Real(1,2) Real(1,3)} are the length,
width and height that define the simulation box. For example, \\ \\
%
\texttt{
\# Box\_Info \\
 1 \\
 orthogonal \\
 30.0 35.0 40.0} \\ \\
%
This will create a simulation box with dimensions 30.0 x 35.0 x 40.0 \AA. \\ \\
%
A non-orthogonal box is created by setting {\it Character(1)} to \texttt{cell\_matrix}.
In this case, three basis vectors are needed to define the simulation box.
Each vector is entered as a column of a 3x3 matrix.
For example, \\ \\
%
\texttt{
\# Box\_Info \\
 1 \\
 cell\_matrix \\
 30 ~0 ~0\\
\hspace*{0.5em}0 35 ~0\\
\hspace*{0.5em}0 ~2 40} \\ \\
%
defines a simulation box with basis vectors (30, 0, 0), (0, 35, 2) and (0, 0, 40).

The optional keyword \texttt{restricted\_insertion} is used to define a region inside the simulation box
in which molecules will be inserted at start-up via \texttt{make\_config} or \texttt{add\_to\_config}
or throughout the simulation via grand canonical insertion moves or Gibbs ensemble swap moves.
\texttt{restricted\_insertion} takes one of several options:
\texttt{sphere}, \texttt{cylinder}, \texttt{slitpore}, \texttt{interface}.
Each option requires additional parameters, as follows.

\begin{itemize}
	\item \texttt{sphere} $R$,
	where $R$ is the radius of a sphere centered at the origin
	\item \texttt{cylinder} $R$,
	where $R$ is the radius of a cylinder centered on the z-axis
	\item \texttt{slitpore} $z_{max}$,
	where $z_{max}$ is half the height of a rectangular prism centered on the {\it xy}-plane
	\item \texttt{interface} $z_{min}$ $z_{max}$,
	defines two rectangular prisms that span the box in the {\it x} and {\it y} directions.
	One box has bounds $z_{min} < z < z_{max}$ and the other has bounds $-z_{max} < z < -z_{min}$.
\end{itemize}

For example, to make a spherical droplet with a radius of 5 \AA\ in cubic box 100 \AA\

\texttt{
\# Box\_Info \\
	1 \\
	cubic \\
	100 \\
	restricted\_insertion sphere 5.0} \\

In addition, the insertion method for each species must be identified in the
\texttt{Start\_Type} or \texttt{Move\_Probability\_Info} sections.

%
%If it's \texttt{SLIT\_PORE} geometry then it is assumed
%that the periodicity is in the xy plane while the slit pore width is
%along the z  In this case {\it
%  Real(i,3) Real(i,4)} provide box dimensions in the x and y
%directions respectively. {\it Real(i,5)} is the pore width if there
%Ewald summation is not enabled. If the simulation uses Ewald summation
%then {\it Real(i,5)} will be the length in the z direction for the
%computation of electrostatic energy using 3D Ewald summation. A good
%starting point is twice the pore width. {\bf Users are encouraged to check
%the convergence of the electrostatic energy by varying {\it
%  Real(i,5)}}. The actual pore width will be determined by {\bf \#
%Pore\_Width} keyword (\autoref{sec:Pore_Width}). \\ \\
%
%
%%%%%%%%%%%%%%%%
%
% Temperature_Info
%
%%%%%%%%%%%%%%%%
\subsection{Temperature}\label{sec:Temperature_Info}
{\bf \# Temperature\_Info} \\
{\it Real(i)} \\ \\
%
{\it Real(i)} is the temperature in Kelvin for box $i$.
For GEMC, the temperature of box 2 will be read from a second line: \\ \\
%
\texttt{
\# Temperature\_Info \\
 300.0 \\
 300.0} \\ \\
%
%%%%%%%%%%%%%%%%
%
% Pressure_Info
%
%%%%%%%%%%%%%%%%
\subsection{Pressure}\label{sec:Pressure_Info}
{\bf \# Pressure\_Info} \\
{\it Real(i)} \\ \\
%
{\it Real(i)} is the pressure setpoint in bar for box $i$.
For GEMC, the pressure of box 2 will be read from a second line: \\ \\
%
\texttt{
\# Pressure\_Info \\
 1.0 \\
 1.0} \\ \\
%
If the simulation type does not require an input pressure (e.g., NVT), this section will be ignored.
%%%%%%%%%%%%%%%%%%
%
%  Chemical_Potential_Info
%
%%%%%%%%%%%%%%%%%%
\subsection{Chemical Potential}\label{sec:Chemical_Potential}
{\bf \# Chemical\_Potential\_Info} \\
{\it Real(1) ... Real(n)} \\ \\
%
where {\it n} is the number of insertable species and {\it Real(i)} is the
chemical potential setpoint (shifted by a species-specific constant) of
insertable species {\it i} in kJ/mol. Each chemical potential will be assigned
in the order species appear in the \texttt{Molecule\_Files} section.
For species with insertion method {\tt none},
the chemical potential can be listed as {\tt none} or omitted.
This section is only read for grand canonical simulations.
See Eq. (\ref{eq:muShift}) for more information.
For example, the adsorption of methane (species 2) in a zeolite (species 1)
can be computed by inserting methane molecules into a box with a zeolite crystal.
In this example, only one chemical potential (for methane) is required
and the following are equivalent: \\ \\
%
\texttt{
\# Chemical\_Potential\_Info \\
 -35.0} \\ \\
%
\texttt{
\# Chemical\_Potential\_Info \\
 none -35.0} \\ \\
%
%%%%%%%%%%%%%%%%
%
% Neighbor_Style
%
%%%%%%%%%%%%%%%%
%\subsection{Neighbor Style}\label{Neighbor_Style}
%{\bf \# Neighbor\_Style} \\
%{\it Character(1) Real(2) or Integer(2)} \\ \\
%
%Sets the option for neighbor list in a simulation. {\it Character(1) } sets the type of Neighbor style
%to be used in the simulation. Acceptable choices are \texttt{verlet} or \texttt{linked\_cell}. If \texttt{verlet} then
%only {\it Real(2)} specifying the thickness of the skin is required. If \texttt{verlet} and $r_{cut} + r_{skin}$ is
%greater than the half box length then an error is generated. \\ \\
%
%For \texttt{linked\_cell}, only {\it Integer(2)} is required. This sets the simulation box for which a linked-cell
%list will be generated. At present, generation of only one linked-cell is supported. With this option, if $3*r_{cut}$
%then an error will be produced. \\ \\
%
%In this absence of this keyword, no neighbor list will be used. \\ \\
%%%%%%%%%%%%%%%%
%
% Reaction_Info
%
%%%%%%%%%%%%%%%%
%\subsection{Reaction}\label{sec:Reaction_Info}
%{\bf \# Reaction\_Info} \\
%{\it Integer(1)}\\
%{\bf reaction method} \\
%{\it Character(2)}\\
%{\it Integer(i,j) } Optional \\
%{\bf stoichiometry} \\
%{\it Integer(i) } \\
%{\bf P0 K0 reaction box} \\
%{\it Real(3) Real(4) Integer(5)} \\
%%
%This section provides information if reactions need to be \texttt{carried out} in
%the simulation. {\it Integer(1)} denotes the total number of reactions. The
%{\bf reaction method} is specified as {\it Character(2)} as either a \texttt{CFC}
%or an \texttt{INTEGER} reaction. If \texttt{INTEGER} is specified as the reaction method, then
%the line ``{\it replacement matrix}'' is required followed by the matrix ``{\it Integer(i,j)}''
%are required. This matrix provides information whether products are to be inserted
%in the whole created by the reactants. For example, in the reaction {\it A + B $\rightarrow$ C},
%if C is placed in the hole created by A and vice versa, the matrix would be: \\ \\
%%
%0 0 1 \\
%0 0 0 \\
%1 0 0 \\ \\
%%
%{\it Integer(i)} sets the stochiometric number of each species in a given reaction.
%For the above example, the \texttt{stochiometry} section would look like: \\ \\
%%
%-1 \\
%-1 \\
%1 \\ \\
%%
%{\it Real(3)} is the total pressure of the system while {\it Real(4)} sets the equilibrium
%constant k$^0$ of the reaction and {\it Integer(5)} is the simulation box in which the
%reaction will take place. \\ \\
%%
%The above section is repeated for all the reactions in the system. \\ \\
%%
%%%%%%%%%%%%%%%%%
%%
%% Bin_Info
%%
%%%%%%%%%%%%%%%%%
%\subsection{Bins}\label{sec:Bin_Info}
%{\bf \# Bin\_Info} \\
%{\it Integer(i)} \\
%{\it Real(i,j)} \\
%{\it Integer(1) Integer(2)} \\ \\
%%
%This section is necessary while performing a CFC MC move.
%For each \texttt{sorbate' species, {\it Integer(i)} defines total number of bins and
%{\it Real(i,j)} is the weight of each bin. There must be {\it Integer(i)} entries on
%this line. The weights, for a given sorbate, are specified on separate lines for each box. Note that, in the beginning of a simulation, all the weights may be set to zero and a Wang-Landau scheme may be utilized to refine the
%weights as the simulation proceeds. The Wang-Landau implementation is controlled by two parameters: {\em Integer(1) Integer(2)}. {\em Integer(1)} specifies the number of Wang-Landau updates to be carried out in the simulation
%before setting the weights to a constant. On the other hand, {\em Integer(2)} specifies the number of MC steps to be carried out in a given Wang-Landau cycle.
%%
%
%%%%%%%%%%%%%%%%
%
% Move_Probabilities
%
%%%%%%%%%%%%%%%%
\subsection{Move Probabilities}\label{sec:Move_Probabilities}
{\bf\# Move\_Probability\_Info \\
{[}subsections] \\
\# Done\_Probability\_Info} \\

This section specifies the probabilities associated with different types of
MC moves to be performed during the simulation.
The section begins with the header {\tt \# Move\_Probability\_Info}
and is terminated by the footer {\tt \# Done\_Probability\_Info}.
All the move probability subsections must be between the section header and footer.

If the move probabilities do not sum to 1.0,
then the probability of each move will be divided by the total.
%
%%%%%%%%%%%%%%%%
%
% Cluster move
%
%%%%%%%%%%%%%%%%
%\subsubsection{Cluster}
%{\bf \# Prob\_Cluster\_Move}\\
%{\it Real(1) }\\
%{\it Real(2) } \\
%{\it Real(i,3)} \\
%{\it Real(i,4)} \\
%{\it Logical(j,5)} \\ \\
%%
%Probability of performing a cluster move is denoted by {\it Real(1)}. The radius of
%the cluster is specified by {\it Real(2)}. On the next line, the maximum displacement
%of cluster in each box is given by {\it Real(i,3)}. The probability of perfoming a
%cluster move in each of the boxes is specified by {\it
%  Real(i,4)}. Whether a species $j$ has a special center-of-mass is
%specified by {\it Logical(j,5)}\\ \\
%
%%%%%%%%%%%%%%%%
%
% Translation
%
%%%%%%%%%%%%%%%%
\subsubsection{Translation}
{\bf \# Prob\_Translation}\\
{\it Real(1)} \\
{\it Real(i,1) ... Real(i,n) } *One line required for each box $i$ \\ \\
%
where $n$ is the number of species.
{\it Real(1)} is the probability of performing a center of mass translation move.
{\it Real(i,j)} is the maximum displacement in \AA\ of species $j$ in box $i$.
This subsection is optional in all ensembles. \\ \\
%
For example, if you have three species and two boxes, you could specify
the translation probability as \\ \\
\texttt{
{ \# Prob\_Translation} \\
 0.25 \\
2.0 2.5 1.0\\
12.0 12.0 12.0}
\\ \\
This will tell Cassandra to attempt center of mass translations 25\%
of the total moves. For box 1, the maximum displacement will be 2.0 \AA\ for
species 1, 2.5 \AA\ for species 2, and 1.0 \AA\ for species 3.
For box 2, the maximum displacement for all species is 12.0 \AA . \\ \\
%
For a simulation that involves solid frameworks,
set the maximum displacement of the solid species to zero.
Every molecule in the simulation with a maximum displacement greater than zero
has an equal chance of being moved.
%
%When fragment
%simulation is carried out, the specification of the move is given by \\ \\
%
%{\bf \# Prob\_Translation}\\
%{\it Real(1)} \\
%{\it Real(2) Real(3)} \\ \\
%
%As before, {\it Real(1)} is the probability of translation move while {\it Real(2)}
%and {\it Real(3)} specify the maximum displacement in cosine of the polar angle
%and maximum change in the azimuthal angle, respectively.
%
%%%%%%%%%%%%%%%%
%
% Pair Translation
%
%%%%%%%%%%%%%%%%
%
%\subsubsection{Pair Translation}
%{\bf \# Prob\_Pair\_Translate}
%{\it Real(1)} \\
%{\it Real(i,2)} \\
%{\it Integer(3)} \\
%{\it Real(j,4)} \\
%{\it Integer(j,1) Integer(j,2) } \\ \\
%%
%This section specifies the probability {\it Real(1)} of performing a
%coupled move involving two molecules(ions) of the same or different
%species. {\it Real(i,2)} indicates the cumulative probability of
%performing such a move in the box $i$. The next line contains {\it
%  Integer(3)} specifying number of pairs to be moved in such a
%move. The cumulative probability for the $j^{th}$ pair is given by
%{\it Real(j,4)} and {\it Integer(j,1) Integer(j,2)} indicate the
%indices of the species involved in the pair  $j$. The last two lines
%are repeated for as many pairs as given by {\it Integer(3)}.


%%%%%%%%%%%%%%%%
%
% Rotation
%
%%%%%%%%%%%%%%%%
\subsubsection{Rotation}
{\bf \# Prob\_Rotation}\\
{\it Real(1)} \\
{\it Real(i,1) ... Real(i,n)} *One line required for each box $i$ \\ \\
%
where $n$ is the number of species.
The probability of performing a rotation move is specified by
{\it Real(1)} while {\it Real(i,j)} denotes the maximum rotation
for species $j$ in box $i$ in degrees about the x, y or z-axis.
The axis will be chosen with uniform probability.
This subsection is optional for all ensembles. \\ \\
%
For example, if you are simulating a single species in two boxes,
you could specify the rotational probability as \\ \\
\texttt{
{ \# Prob\_Rotation} \\
 0.25 \\
30.0\\
180.0} \\ \\
%
Twenty-five percent of the attempted moves will be rotations.
Molecules in box 1 will be rotated a maximum of 30\degree\ around the x, y, or z-axis.
Molecules in box 2 will be rotated a maximum of 180\degree\ around the x, y, or z-axis. \\ \\
%
If all species are point particles (such as single-site Lennard-Jones particles),
this section should be omitted.
For a multi-species system,
set {\it Real(i,j)} to zero for point particles and solid frameworks. \\ \\
%
Linear molecules are a special case.
A molecule is identified as linear if all angles in the MCF are fixed at 180\degree .
If a linear molecule were aligned with the axis of rotation,
then the molecular orientation would not be changed.
Therefore, linear molecules are rotated by choosing a random unit vector with uniform probability
without regard to the molecule's current orientation or the maximum rotation.
As with non-linear molecules, if {\it Real(i,j)} is zero, no molecules of species $j$ will be rotated. \\ \\
%
For a single box simulation of a non-linear molecule (species 1), a linear molecule (species 2),
and a point particle (species 3), you could specify \\ \\
%
\texttt{
{\# Prob\_Rotation} \\
 0.25 \\
30.0 10.0 0.0} \\ \\
%
Molecules of species 1 will be rotated a maximum of 30\degree\ around the x, y or z-axis,
molecules of species 2 will be rotated by choosing a random unit vector, and
the point particles will not be rotated.
%
%%%%%%%%%%%%%%%%
%
% Angle perturbation
%
%%%%%%%%%%%%%%%%
\subsubsection{Angle}
{\bf \# Prob\_Angle} \\
{\it Real(1)} \\
A molecule will be selected at random and its angle will be perturbed based on its Boltzmann weighted distribution.
The probability of attempting this move is the only required input. It is specified by {\it Real(1)}. Note that this move is rarely needed since the fragment libraries should already provide efficient sampling of angles. This move, however, may improve sampling of angles for large molecules in the case where parts of its fragments are rarely regrown by a regrowth move.

%
\texttt{
\# Prob\_Angle \\
0.3 \\
} \\
%
This will tell Cassandra to attempt angle moves 30\% of the total moves for all molecules containing angles within a given box.

%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%
%
% Dihedral move
%
%%%%%%%%%%%%%%%%
\subsubsection{Dihedral}
{\bf \# Prob\_Dihedral} \\
{\it Real(1)} \\
{\it Real(1) ... Real(n)} \\

The probability of performing a dihedral move is specified by {\it Real(1)} while
{\it Real(n)} denotes the maximum width of a dihedral angle displacement for each species. The maximum width is given in degrees. Note that this move is rarely needed since the regrowth moves should already provide efficient sampling of dihedrals. This move, however, may improve sampling of dihedrals for large molecules in the case where the parts of its fragments are rarely regrown (albeit a small maximum width is provided).\\ \\
%
\texttt{
\# Prob\_Dihedral \\
0.3 \\
20 0.0 \\
}\\
%
This will tell Cassandra to attempt dihedral moves 30\% of the total moves for all molecules containing dihedrals within a given box.
The maximum dihedral width will be 20\degree\ for species 1 and 0.0\degree\
for species 2. Since the maximum dihedral
width of species 2 is set to 0.0\degree\ in both boxes, no dihedral moves will be
attempted on species 2. Note that a single max dihedral width is provided, even if species 1 may contain many dihedrals. This is also true
for simulations with more than one box. Also note that the same max dihedral width is used for systems containing  more than one box.

%
%%%%%%%%%%%%%%%%
%
% Regrowth
%
%%%%%%%%%%%%%%%
\subsubsection{Regrowth}
{\bf \# Prob\_Regrowth} \\
{\it Real(1)} \\
{\it Real(2,1) ... Real(2,n)} \\ \\
%
where $n$ is the number of species.
A regrowth move consists of deleting part of the molecule randomly and
then regrowing the deleted part via configurational bias algorithm.
This can result in relatively substantial conformational changes for
the molecule, but the cost of this move is higher than that of a
simple translation or rotation. The probability of attempting a
regrowth move is specified by {\it Real(1)} while {\it Real(2,i)}
specifies the relative probability of performing this move on species $i$.
The relative probabilities must sum to 1 otherwise Cassandra will quit with an error.
This subsection is optional for all ensembles. \\ \\
%
For example, if simulating 70 molecules of species 1 and 30 molecules of species 2,
you could specify the following: \\ \\
%
\texttt{
\# Prob\_Regrowth \\
0.3 \\
0.7 0.3 } \\ \\
%
Thirty percent of the attempted moves will be regrowth moves.
Seventy percent of the regrowth moves will be attempted on a molecule of species 1
and the balance of regrowth moves on a molecule of species 2. \\ \\
%
{\it Real(2,i)} should be set to zero for monatomic, linear, or rigid species, including solid frameworks.
%
%%%%%%%%%%%%%%%%
%
% Volume displacement
%
%%%%%%%%%%%%%%%%
\subsubsection{Volume}
{\bf \# Prob\_Volume} \\
{\it Real(1)} \\
{\it Real(2)} \\
{[}{\it Real(3)}] \\ \\
%{\it Integer(1)} *Optional \\ \\
%
{\it Real(1)} is the relative probability of attempting a box volume change.
Since volume changes are computationally expensive, this probability should
normally not exceed 0.05 and values from 0.01-0.03 are typical.
{\it Real(2)} is the maximum volume displacement in \AA$^3$ for box 1.
{\it Real(3)} is the maximum volume displacement in \AA$^3$ for box 2,
and is only required for GEMC-NPT simulations.
The attempted change in box volume is selected from a uniform distribution.
This subsection is required for NPT, GEMC-NPT and GEMC-NVT simulations.
%
For example, if you are simulating a liquid with a single box in the NPT ensemble,
you would specify the following: \\ \\
%
\texttt{
\# Prob\_Volume \\
0.02 \\
300} \\ \\
%
This will tell Cassandra to attempt volume moves 2\% of the
total moves. The box volume would be changed by random amounts ranging from
-300 \AA$^3$ to +300 \AA$^3$. For a liquid box 20 \AA\ per side,
this would result in a maximum box edge length change of about 0.25
\AA, which is a reasonable value.
Larger volume changes should be used for vapor boxes.
%
If you wish to perform a GEMC-NPT simulation, you might specify the
following: \\ \\
%
\texttt{
\# Prob\_Volume \\
0.02 \\
300 \\
5000} \\ \\
%
This will tell Cassandra to attempt volume moves 2\% of the
total moves. The first box volume (assumed here to be smaller and of higher
density, such as would occur if it were the liquid box) would be
changed by random amounts ranging from
-300 \AA $^3$ to +300 \AA $^3$. The second box volume would be
changed by random amounts ranging from
-5000 \AA $^3$ to +5000 \AA $^3$. As with all move probabilities, you
can experiment with making
larger or smaller moves. Note that if the \# Run\_Type is set
to {\tt equilibration}, Cassandra will attempt to optimize the magnitude of
the volume change to achieve about 50\% acceptance rates.

The volume perturbation move is only supported for cubic boxes.
%If you wish to perform a GEMC-NVT simulation, you might specify the
%following: \\ \\
%
%\texttt{
%\# Prob\_Volume \\
%0.02 \\
%300 \\
%1} \\ \\
%
%This would change each box by a maximum of $\pm$300 \AA $^3$ but
%instead of uniformly, it will change the volume on $\ln V$.





%%%%%%%%%%%%%%%%
%
% Insertion
%
%%%%%%%%%%%%%%%% 
\subsubsection{Insertion and Deletion Moves}
{\bf \# Prob\_Insertion} \\
{\it Real(1)} \\
{\it Character(2,1) ... Character(2,n)} \\ \\
%
where $n$ is the number of species.
{\it Real(1)} sets the probability of attempting insetion moves.
{\it Character(2,i)} is the insertion method and can be either
\texttt{cbmc}, \texttt{none}, or \texttt{restricted}.
If \texttt{cbmc}, species $i$ will be inserted by assembling its
fragments using configurational bias Monte Carlo.
If \texttt{none}, species $i$ will not be inserted or deleted.
If \texttt{restricted}, species $i$ will be assembled using CBMC
with the first fragment inserted into the region defined by
the \texttt{restricted\_insertion} keyword in the \texttt{Box\_Info} section.
\textbf{Note that restricted insertions should only be used if the
relevant molecules cannot escape the restricted region during
the simulation. If this condition is not met the acceptance criteria
for molecule deletion will be incorrect and the ensemble will not be
properly sampled.}
This subsection is required for GCMC simulations. \\ \\
%
If there is more than one insertable species, each is chosen for an insertion attempt with equal probability.
For example, if you are performing a GCMC simulation with two species that can
be inserted, you might specify the following \\ \\
%
\texttt{
\# Prob\_Insertion \\
0.1 \\
cbmc cbmc} \\ \\
%
This will tell Cassandra to attempt insertions 10\% of the total moves and
both species will be inserted using CBMC.
If only species 1 is to be inserted or deleted, use \\ \\
%
\texttt{
\# Prob\_Insertion \\
0.1 \\
cbmc none} \\ \\
%
%%%%%%%%%%%%%%%%
%
% Deletion
%
%%%%%%%%%%%%%%%
{\bf \# Prob\_Deletion} \\
{\it Real(1)} \\ \\
%
{\it Real(1)} is the probability of attempting to delete a molecule during a simulation,
and must match the insertion probability to satisfy microscopic reversibility.
The molecule to delete is selected by first choosing a species with uniform probability,
and then choosing a molecule of that species with uniform probability.
If a species has the insertion method \texttt{none}, no attempt is made to delete it.
This subsection is required for GCMC simulations. \\ \\
%
%%%%%%%%%%%%%%%%
%
% Swap
%
%%%%%%%%%%%%%%%
{\bf \# Prob\_Swap}\\
{\it Real(1)} \\
{\it Character(2,1) ... Character(2,n)} \\
{[}{\tt prob\_swap\_species} {\it Real(3,1) ... Real(3,n)}] \\
{[}{\tt prob\_swap\_from\_box} {\it Real(4,1) ... Real(4,i)}] \\ \\
%
where $n$ is the number of species and $i$ is the number of boxes.
{\em Real(1)} is the probability of attempting to transfer a molecule from one box to another.
Similar to the \texttt{\# Prob\_Insertion} subsection,
{\em Character(2,i)} is the insertion method and can be
\texttt{cbmc}, \texttt{none}, or \texttt{restricted}.
If \texttt{cbmc}, species $i$ will be inserted by assembling its
fragments using configurational bias Monte Carlo.
If \texttt{none}, species $i$ will not be transferred between boxes.
If \texttt{restricted}, species $i$ will be assembled using CBMC
with the first fragment inserted into the region defined by
the \texttt{restricted\_insertion} keyword in the \texttt{Box\_Info} section.
This subsection is required for a GEMC simulation. \\ \\
%
For example, while performing a GEMC simulation for three species the first two of which are exchanged
while the third is not, specify the following: \\ \\
%
\texttt{ \# Prob\_Swap\\
0.1 \\
cbmc cbmc none \\ \\
}
%
This will tell Cassandra to attempt swap moves 10\% of the total moves.
Attempts will be made to transfer species 1 and 2 between available boxes while molecules
of species 3 will remain in the boxes they are present in at the start of the simulation. \\ \\
%
By default, a molecule is chosen for the attempted swap with uniform probability
(amongst swappable molecules).
As a result, if one species has a much higher mole fraction in the system
(e.g. if calculating methane solubility in liquid water),
then most attempted swaps will be of the more abundant species.
This behavior can be changed by using the optional keywords
{\tt prob\_swap\_species} and {\tt prob\_swap\_from\_box}. \\ \\
%
The keyword \texttt{prob\_swap\_species} must be given with $n$ options:
{\it Real(3,j)} is the probability of selecting species $j$.
The keyword {\tt prob\_swap\_from\_box} must be given with $i$ options:
{\it Real(4,j)} is the probability of selecting a molecule from box $j$.
For example, to select a molecule of species 1 for 90\% of attempted swaps and
to select box 2 as the donor box for 75\% of attempted swaps, use: \\ \\
%
\texttt{ \# Prob\_Swap\\
0.1 \\
cbmc cbmc none \\
prob\_swap\_species 0.9 0.1 0.0 \\
prob\_swap\_from\_box 0.25 0.75 \\ \\ }
%
The probability of selecting a species with insertion method \texttt{none} must be 0. \\ \\
%
%%%%%%%%%%%%%%%%
%
% Identity Switch
%
%%%%%%%%%%%%%%%%
%{\bf \# Prob\_Identity\_Switch}\\
%{\it Real(1) \it Character(1) Character(2)}\\
%{\it Character(3,1) Character(3,2)} \\
%...\\
%{\it Character(n+3,1) Character(n+3,2)}\\ \\
%%
%\textit{Real(1)} is the probability of attempting to interchange or switch the species identity of two randomly selected molecules (from different starting species). \\ \\
%%
%\textit{Character(1)} specifies the number of trial rotations (around the center of mass) among which one is chosen proportional to its Boltzmann weight (Rosenbluth sampling). This process occurs for both molecules involved in an identity switch. If omitted no rotations are attempted.\\ \\
%%
%\textit{Integer(3,1) and Integer(3,2)} are optional and represent a species index pair. The number of species index pairs is entered as \textit{Character(2)}. \textit{Character(2)} can be omitted if these index pairs are also omitted. One of these species index pairs will be selected with uniform probability. The first molecule to be switched will be selected with uniform probability among all molecules of the first species in the selected pair, and likewise with the second molecule to be switched with the second species in the pair. If omitted, any combination of species may be selected.\\ \\
%%
%%
%For example: \\ \\
%\# Prob\_Identity\_Switch \\
%0.05 0 \\ \\
%%
%Will attempt identity switch moves for 10\% of all moves. No trial rotations
%will be performed. An identity switch of pair of molecules (not from the same
%species) is equally likely to be proposed.\\ \\
%%
%%
%\# Prob\_Identity\_Switch \\
%0.05 5 2 \\
%1 2 \\
%2 3 \\ \\
%%
%Will attempt identity switch moves for 5\% of all moves. 5 trial rotations will
%be attempted for Rosenbluth sampling. Molecules of species 1 will only be
%switched with molecules of species 2, and likewise with Moleclues of species 3
%and molecules of species 2. This may be advantageous if species 1 is small,
%species 3 is large, and species 2 is medium in size.\\ \\
%
%
%
%
%
%%%%%%%%%%%%%%%%
%
% Swap
%
%%%%%%%%%%%%%%%
{\bf Flip Move}\\ \\
{\bf \# Prob\_Ring} \\
{\it Real(1) Real(2)} \\ \\
%
This subsection is used when flip moves are to be attempted to sample bond angles and
dihedral angles in a ring fragment.
For more details on this move see Ref. \cite{Shah:2011}.
Note that this subsection is used only in input files
that generate configuration libraries of ring moieties. The input file of the
actual simulation would involve the \texttt{\# Prob\_Regrowth} keyword.
The relative probability of attempting a flip move is
specified by {\it Real(1)} while the maximum angular displacement
in degrees for the move is given by {\it Real(2)}.
For example, if the flip is to be attempted 30\% of the
time and the maximum angular displacement for the
move is 20\degree~specify the following: \\ \\
%
\texttt{
\# Prob\_Ring \\
0.30 20.0 \\ \\}
%
%
%%%%%%%%%%%%%%%%%
%%
%% Reaction probability
%%
%%%%%%%%%%%%%%%%
%\subsubsection{Reaction}
%{\bf \# Prob\_React} \\
%{\it Real(1)} \\
%{\bf insertion method}\\
%{\it Character(i,1)} \\
%{\bf configuration file} or {\bf Number of igas particles} \\
%{\it Character(i,2)} or {\it Integer(i,1)} \\
%{\bf Nupdate, Nmoves} \\
%{\it Integer(i,2) Integer(i,3)} \\ \\
%%
%Specifies the relative probability of performing reaction move. If multiple reactions
%are involved, one will be selected at random. The insertion section is the same as that
%for '\# Prob\_Insertion'. \\ \\
%%
%%%%%%%%%%%%%%%%%
%%
%% Ensemble change probability
%%
%%%%%%%%%%%%%%%%
%%
%\subsubsection{Ensemble Change}\label{Sec:Prob_Ensemble}
%{\bf \# Prob\_Ensemble}
%{\it Real(1) Real(2)}
%Provides the relative probability ({\it Real(1)}) of performing a
%change in the state of a tagged particle (gradual insertion). {\it
%  Real(2)} sets the relative probability of a random walk in temperature.
%%%%%%%%%%%%%%%%
%
% Ring probability
%
%%%%%%%%%%%%%%%
%\subsubsection{Ring}
%{\bf \# Prob\_Ring}
%{\it Real(1)} \\
%{\it Real(2)} \\ \\
%%
%Relative probability of sampling rings in the system. {\it Real(1)} specifies this
%probability and {\it Real(2)} is the maximum angular rotation in degrees for the
%flip move. \\ \\
%
%%%%%%%%%%%%%%%%
%
% Atom displacement probability
%
%%%%%%%%%%%%%%%
%\subsubsection{Atom Displacement}
%{\bf \# Prob\_Atom\_Displacement} \\
%{\it Real(1) } \\
%{\it Real(2) Real(3) } \\
%%
%The relative probability of performing atom displacement move is given by {\it Real(1)}.
%The {\it Real(2) Real(3)} are the maximum displacements in the cosine of polar angle and
%azimuthal angle of the atom in degrees. \\ \\
%
%%%%%%%%%%%%%%%%
%
% Lambda moves
%
%%%%%%%%%%%%%%%
%\subsubsection{Lambda Change}
%{\bf \# Prob\_Lambda} \\
%{\it Character(i,1) Character(i,2) Real(i,3)} *One line required per species. \\ \\
%%
%{\it Real(1)} is the relative probability of performing a lambda move on the fractional
%particle in the system. {\it Character(i,1)} is the file from which to obtain configuration
%for species $i$ when a lambda move results in an insertion. {\it Character(i,2)} sets the
%insertion method for the new fractional molecule in the system. Currently, only \texttt{RANDOM}
%is supported. {\it Real(i,3)} is the maximum change in lambda for species $i$. \\ \\
%%
%%%%%%%%%%%%%%%%
%
% Probability of swap between boxes
%
%%%%%%%%%%%%%%%
%\subsubsection{Swap between boxes}
%{\bf \# Prob\_Swap\_Box} \\
%{\it Integer(i) Real(i,1) Real(i,2) ...} * As many {\it Real(i,j)} as there are boxes. \\ \\
%
%This section specifies the relative probability of exchange between two boxes $i$ and $j$.
%For each box $i$, on the same line are specified probabilities for choosing a pair of boxes
%$i$ and $j$. \\ \\
%
%%%%%%%%%%%%%%%%
%
% Start_Type
%
%%%%%%%%%%%%%%%%
\subsection{Start Type}\label{sec:Start_Type}
{\bf \# Start\_Type} \\
{\it Character(1) } \\
{[}{\it Character(2) }] \\
{[}{\tt insertion} {\it Character(3,1) ... Character(3,n)}] \\ \\
%
This section specifies whether Cassandra generates an initial configuration or
uses a previously generated configuration to start a simulation.
{\it Character(1)} [{\it Character(2)}] can be one of four keywords:
{\tt make\_config}, {\tt read\_config}, {\tt add\_to\_config}, or {\tt checkpoint}.

{\tt make\_config} and {\tt add\_to\_config} are options to construct an initial configuration
by inserting a specified number of molecules of each species.
Each molecule is inserted using configuration bias Monte Carlo,
using {\tt kappa\_ins} trial locations for the first fragment and
{\tt kappa\_dih} trial rotations for each additional fragment.
Trial locations and rotations that place two atoms closer than {\tt Rcutoff\_Low} \AA\ have zero weight.
Otherwise the weight of the trial location is computed as discussed in section \ref{sec:cbmcInsert} and
one trial is selected proportionate to its weight.
If all trial locations have zero weight, the insertion is rejected and re-attempted.
This process does not utilize a chemical potential
nor does it compute the change in energy from inserting the fully assembled molecule.
As a result, these routines will allow the user to insert more molecules than
are thermodynamically reasonable at finite temperature or finite chemical potentials.
This can be particularly problematic for deleting molecules in GCMC and GEMC simulations.
When computing the reverse probability for inserting that molecule back into the location it's being deleted from,
if the reverse move is more than 708 $k_BT$ uphill, then the acceptance probability blows up. \\
%
\begin{itemize}
\item \textbf{make\_config} will generate an initial configuration using a configurational biased scheme.
The number of molecules of each species is specified as follows: \\ \\
%
{\bf \# Start\_Type} \\
{\tt make\_config} {\it Integer(1) ... Integer(n)} \\ \\
%
where {\it n} is the number of species and {\it Integer(i)} is the number of molecules of species $i$ to insert into the box.
This keyword can be repeated for each box.
For example, to generate an initial configuration with 100 molecules of species 1 and 75 molecules of species 2 \\ \\
%
 \texttt{
 \# Start\_Type \\
 make\_config 100 75 \\} \\
%
If the simulation also has a second box with 25 molecules of species 2 only \\ \\
%
 \texttt{
 \# Start\_Type \\
 make\_config 100 75\\
 make\_config \ \ 0 25\\}
%
Please note the caution regarding {\tt make\_config} at the end of this section. \\
%
\item {\textbf{read\_config}} will use the coordinates from an .xyz file.
For example, a configuration generated at one temperature may be used to initiate a simulation at another temperature.
After {\tt read\_config} the number of molecules of each species must be given, followed by the .xyz filename: \\ \\
%
{\bf \# Start\_Type} \\
{\tt read\_config} {\it Integer(1) ... Integer(n) Character(1)}\\ \\
%
where {\it n} is the number of species, {\it Integer(i)} is the number of molecules
of species $i$ to read from file {\it Character(1)}.
This keyword can be repeated for each box.
For example, to start a simulation using a configuration of 50 molecules each of species 1 and 2: \\ \\
%
\texttt{
\# Start\_Type \\
read\_config 50 50 liquid.xyz \\} \\
%
If the simulation also has a second box with 10 molecules of species 1 and 90 molecules of species 2: \\ \\
%
\texttt{
\# Start\_Type \\
read\_config 50 50 liquid.xyz \\
read\_config 10 90 vapor.xyz \\} \\
%
The .xyz files must have the following format:\\ \\
%
\texttt{
 <number of atoms>\\
 comment line\\
 <element> <x> <y> <z>\\
 ...\\
} \\
%
%The utility \texttt{read\_config.py} is provided to speed up the restart of simulations using the {\tt read\_config} option.
%This tool extracts the last configuration from a previous run, as well as relevant information from the checkpoint file
%such as maximum displacements for angles or translations. It then creates new input and xyz files that can readily be
%used to restart a simulation using the {\tt read\_config} option. This script is located in \texttt{Scripts/Read\_Config}.
%For more information, refer to the README file located in the same directory.

\item {\textbf{add\_to\_config}} will read the coordinates from an .xyz file, but then insert additional molecules.
After {\tt add\_to\_config} specify the number of molecules of each species to be read, followed by the .xyz filename,
followed by the number of molecules of each species to be added: \\ \\
%
{\bf \# Start\_Type} \\
{\tt add\_to\_config} {\it Integer(1) ... Integer(n) Character(1) Integer(n+1) ... Integer(2n)}\\ \\
%
where {\it n} is the number of species, {\it Integer(1)} through {\it Integer(n)} are the number of molecules of each
species to read from file {\it Character(1)}, and {\it Integer(n+1)} through {\it Integer(2n)} are the number of molecules
of each species to add to the configuration.
This keyword can be repeated for each box.
For example, to start a simulation by reading in a zeolite (speces 1) configuration and adding 30 molecules of methane (species 2): \\ \\
%
\texttt{
\# Start\_Type \\
add\_to\_config  1  0 MFI.xyz 0 30 \\} \\
%
where the file \texttt{MFI.xyz} contains the coordinates of a unit cell of MFI silicalite. \\
%
Please note the caution regarding {\tt add\_to\_config} at the end of this section. \\
%
\item \textbf{checkpoint} this keyword is used to restart a simulation from a checkpoint file.
During the course of a simulation, Cassandra periodically generates a checkpoint file (*.chk)
 containing information about the total number of translation, rotation and volume moves along with the random number seeds and
the coordinates of each molecule and its box number at the time the file is written. Cassandra provides
the capability of restarting from this state point in the event that a simulation crashes or
running a production simulation from an equilibrated configuration. For this
purpose, in addition to the {\tt checkpoint} keyword, additional information in the form of the name of
the checkpoint file {\it Character(1)} is required in the following format: \\ \\
%
{\bf \# Start\_Type} \\
{\tt checkpoint} {\it Character(1)} \\ \\
%
For example, to continue simulations from a checkpoint file `methane\_vle\_T148.chk', you might specify: \\ \\
%
\texttt{
\# Start\_Type \\
checkpoint methane\_vle\_T148.chk \\ } \\
%
Note that when a {\tt checkpoint} file is used to restart a simulation, the seeds for random number generation supplied by the user
will be overwritten by those present in the checkpoint file. By contrast, if \# Start\_Type is set to {\tt read\_config},
then the seeds specified in the input file are used.  \\ \\
%
\end{itemize}
Unless starting from a checkpoint file, input files for a multi-box simulation must have one line for each box in the \texttt{Start\_Type} section. Each line can start with a different keyword. For example, a GEMC simulation of a water(1)-methane(2) mixture can begin from an equilibrated water box and a new vapor box: \\ \\
%
\texttt{
\# Start\_Type \\
read\_config 100 \ \ 0 water.xyz \\
make\_config \ 50 \ 50 \\}

The keyword {\tt insertion} is optional and is only meaningful if used in conjunction
with the keyword {\tt restricted\_insertion} in the {\tt Box\_Info} section and
either the {\tt make\_config} or {\tt add\_to\_config} keywords in this section.
{\it Character(3,i)} is the insertion method for species $i$ and can be one of the following options:
{\tt cbmc}, {\tt none}, or {\tt restricted}.
If {\tt cbmc}, species $i$ will be assembled using configurational bias Monte Carlo.
If {\tt none}, species $i$ will not be inserted.
If \texttt{restricted}, species $i$ will be assembled using CBMC
with the first fragment inserted into the region defined by
the \texttt{restricted\_insertion} keyword in the \texttt{Box\_Info} section. \\
%
%%%%%%%%%%%%%%%%
%
% Run_Type
%
%%%%%%%%%%%%%%%%
\subsection{Run Type}\label{sec:Run_Type}
{\bf \# Run\_Type} \\
{\it Character(1)} {\it Integer(1)} [{\it Integer(2)}] \\ \\
%
This section is used to specify whether a given simulation is an equilibration or a production run.
For an equilibration run, the maximum translational, rotational, torsional and volume widths (for an NPT or a GEMC
simulation) are adjusted to achieve 50\% acceptance rates. During a production run, the maximum
displacement width for different moves are held constant. \\ \\
%
Depending on the type of the simulation,
{\it Character(1)} can be set to either \texttt{equilibration} or \texttt{production}.
For an \texttt{equilibration} run, {\it Integer(1)} denotes
the number of MC steps performed for a given thermal move before the corresponding maximum
displacement width is updated. {\it Integer(2)} is the number of MC volume moves after which the volume
displacement width is updated. This number is optional if no volume moves are performed during a simulation (for example in an NVT or
a GCMC simulation). When the run type is set to \texttt{production}, the MC moves refer to the frequency at which the acceptance
ratios for various moves will be computed and output to the log file. These acceptance rates should be checked to make sure proper sampling is achieved. \\ \\
%
For an NPT equilibration run in which the widths of the thermal move are to be updated after 1000 MC moves and
maximum volume displacements after 100 volume moves, specify the following: \\ \\
%
\texttt{
\# Run\_Type \\
equilibration 100 10 \\ \\}
%
%
For an NVT production run in which the acceptance ratios of various thermal moves are printed to the log file after
every 250 MC steps of a given thermal move, use the following: \\ \\
%
\texttt{
\# Run\_Type \\
production 250}
%
%%%%%%%%%%%%%%%%
%
% Simulation_Length
%
%%%%%%%%%%%%%%%%
\subsection{Simulation Length}\label{sec:Simulation_Length_Info}
{\bf \# Simulation\_Length\_Info} \\
{\tt units} {\it Character(1)} \\
{\tt prop\_freq} {\it Integer(2)} \\
{\tt coord\_freq} {\it Integer(3)} \\
{\tt run} {\it Integer(4)} \\
{[}{\tt steps\_per\_sweep} {\it Integer(5)}] \\
{[}{\tt block\_averages} {\it Integer(6)}] \\ \\
%
This section specifies the frequency at which thermodynamic properties and coordinates are output to a file.
The \texttt{units} keyword determines the method by which the simulation is terminated and data is output.
{\it Character(1)} can be {\tt minutes}, {\tt steps}, or {\tt sweeps}.
Thermodynamic quantities are output every {\it Integer(2)} units,
coordinates are written to the disk every {\it Integer(3)} units and
the simulation will stop after {\it Integer(4)} units. \\ \\
%
If {\it Character(1)} is {\tt minutes}, then the simulation runs for a specified time.
For example, to run a simulation for 60 minutes with thermodynamic properties written every minute and
coordinates output every 10 minutes, use: \\ \\
%
\texttt{
\# Simulation\_Length\_Info \\
units         minutes \\
prop\_freq    1 \\
coord\_freq   10 \\
run           60 \\} \\
%
If {\it Character(1)} is {\tt steps}, the simulation runs for a specified number of MC steps.
An MC step is defined as a single MC move, regardless of type and independent of system size.
To run a simulation of 50,000 steps such that thermodynamic quantities are printed every 100 MC steps and
coordinates are output every 10,000 steps, use: \\ \\
%
\texttt{
\# Simulation\_Length\_Info \\
units           steps \\
prop\_freq      100 \\
coord\_freq     10000 \\
run             50000 \\ } \\
%
If {\it Character(1)} is {\tt sweeps}, the simulation runs for a specified number of MC sweeps.
The number of MC steps per sweep can be defined using the optional keyword \\ \\
%
steps\_per\_sweep {\it Integer(5)} \\ \\
%
The default \texttt{steps\_per\_sweep} value is the sum of the weights of each move type.
A sweep is typically defined as the number of MC moves needed for every move to be attempted for every molecule.
For example, in a water box of 100 molecules in the NPT ensemble, a sweep would be 201 moves---100 translations,
100 rotations and 1 volume change.
To run a simulation of 1,000 sweeps with thermodynamic quantities are printed every 100 sweeps
and coordinates are output every 100 sweeps, use the following: \\ \\
%
\texttt{
\# Simulation\_Length\_Info \\
units             sweeps \\
prop\_freq        100 \\
coord\_freq       100 \\
run               1000 \\
steps\_per\_sweep 201 \\} \\
%
The optional keyword {\tt block\_avg\_freq} switches the thermodynamic output from instantaneous values
to block average values, where {\it Integer(6)} is the number of units per block.
The number of blocks is given by {\it Integer(4)}/{\it Integer(6)}
and the number of data points per block is {\it Integer(6)}/{\it Integer(2)}.
For example, during a run of 1,000,000 steps, with properties computed every 100 steps and
averaged every 100,000 steps, specify
%
\texttt{
\# Simulation\_Length\_Info \\
units             steps \\
run               1000000 \\
block\_avg\_freq  100000 \\
prop\_freq        100 \\
coord\_freq       100 \\} \\
%
This simulation will output 10 averages, and each average will be computed from 1000 data points.
%
%%%%%%%%%%%%%%%%
%
% Property_Info
%
%%%%%%%%%%%%%%%%
\subsection{Property Output}\label{sec:Property_Info}
{\bf \# Property\_Info} {\it Integer(i)} \\
{\it Character(i,j) *One line for each property $j$} \\ \\
%
This section provides information on the properties that are output.
More than one section is allowed for multiple boxes.
In this case, each section is separated by a blank line.
{\it Integer(i)} is the identity of the box for which the properties are desired.
{\it Character(i,j)} is the property that is to be output.
Each property is specified on a separate line.

All energies are in kJ/mol and are extensive, i.e.
if the numbers of molecules in a simulation are doubled, the magnitude of the energy will also double.
The kJ unit of energy is the right order of magnitude for molar quantities, $\mathcal{O}(10^{23})$ molecules.
Cassandra is designed for simulations of $\mathcal{O}(100-1000)$ molecules,
which will have much smaller internal energies, $\mathcal{O}(10^{-21})$ kJ.
Rather than report energies in zeptojoules or eV, we have opted to multiply the energies by Avogadro's number.
Or, equivalently, you can interpret the output energies as the energy for a mole of simulation boxes.
To get extensive energies in kJ, divide the output energies by Avogadro's number.
To get intensive energies in kJ/mol, divide the output energies by the number of molecules
(only strictly valid for single species simulations).
The following components of the energy can be output:

\texttt{energy\_total}: total energy of the system, the sum of \texttt{energy\_intra} and \texttt{energy\_inter} \\
\texttt{energy\_intra}: intramolecular energy, the sum of the following terms
\begin{itemize}
\item \texttt{energy\_bond}: bond energy
\item \texttt{energy\_angle}: angle energy
\item \texttt{energy\_dihedral}: dihedral energy
\item \texttt{energy\_improper}: improper energy
\item \texttt{energy\_intravdw}: intramolecular van der Waals energy
\item \texttt{energy\_intraq}: intramolecular electrostatic energy.
In the case of Ewald and DSF methods, this is the real-space intramolecular electrostatic energy.
\end{itemize}
\texttt{energy\_inter}: intermolecular energy, the sum of the following terms
\begin{itemize}
\item \texttt{energy\_intervdw}: intermolecular van der Waals energy
\item \texttt{energy\_lrc}: long range tail correction for the truncated van der Waals energy
\item \texttt{energy\_interq}: intermolecular electrostatic energy.
In the case of Ewald and DSF methods, this is the real-space intermolecular electrostatic energy.
\item \texttt{energy\_recip}: electrostatic reciprocal energy, for Ewald and DSF methods
\item \texttt{energy\_self}: electrostatic self energy, for Ewald method
\end{itemize}

Additional supported keywords are: \\ \\
\texttt{enthalpy}: enthalpy of the system, in kJ/mol (extensive).
The enthalpy is computed using the pressure setpoint for isobaric simulations and
the computed pressure for all other ensembles. \\
\texttt{pressure}: pressure of the system, in bar \\
\texttt{pressure\_xx}: the xx-component of the pressure tensor, in bar \\
\texttt{pressure\_yy}: the yy-component of the pressure tensor, in bar \\
\texttt{pressure\_zz}: the zz-component of the pressure tensor, in bar \\
\texttt{volume}: volume of the system, in \AA$^3$ \\
\texttt{nmols}: number of molecules of each species \\
\texttt{density}: number density of each species, in \#/\AA$^3$ \\
\texttt{mass\_density}: density of the system, in kg/m$^3$ \\ \\
%
For example, if you would like total energy, volume and pressure of a one box system to be written, you may
specify the following: \\ \\
%
\texttt{
\# Property\_Info 1 \\
energy\_total \\
volume \\
pressure \\ \\}
%
For a GEMC-NVT simulation, total energy and density of all the species in box 1 and total energy, density of
all the species in box 2 along with the pressure may be output using the following format: \\ \\
%
\texttt{
\# Property\_Info 1 \\
energy\_total \\
density \\ \\
%
\# Property\_Info 2 \\
energy\_total \\
density \\
pressure }
%
%%%%%%%%%%%%%%%%
%
% Fragment_Files
%
%%%%%%%%%%%%%%%%
\subsection{Fragment Files}\label{sec:Fragment_Files}
{\bf \# Fragment\_Files} \\
{\it Character(i)} {\it Integer(i)} *One line for each fragment $i$ \\ \\
%
In this section, information about the fragment library is specified. {\it Character(i)} gives
the location of the fragment library of fragment $i$; {\it Integer(i)} is the
corresponding integer id specifying the type of the fragment. This section is automatically
generated by library\_setup.py. However, if there is a need to change this section, follow the example
given below. \\ \\
%
For a simulation involving two species of which the first one contains three distinct fragments and species 2
has two identical fragments, this section might look like: \\ \\
%
\texttt{
\# Fragment\_Files  \\
frag\_1\_1.dat 1 \\
frag\_2\_1.dat 2 \\
frag\_3\_1.dat 3 \\
frag\_1\_2.dat 4 \\
frag\_1\_2.dat 4 \\ \\
}
%
This will tell Cassandra to use the files frag\_1\_1.dat, frag\_2\_1.dat and frag\_3\_1.dat for the three
fragments of species 1. Since species 2 has two identical fragment, Cassandra will use the same
fragment library frag\_1\_2.dat for these fragments.

%%%%%%%%%%%%%%%%
%
% Verbose_logfile
%
%%%%%%%%%%%%%%%

\subsection{Verbosity in log file}\label{sec:Verbose_Logfile}
{\bf \# Verbose\_Logfile} \\
{\it Logical} \\ \\
%
This optional section is used to control the level of detail about the simulation
setup that is output to the log file.
Controlling this can be useful for development purposes.
If this section is missing, {\it Logical} is set to {\tt false} by default.
Supported options for {\it Logical} are {\tt true} or {\tt false}. \\ \\
%
%%%%%%%%%%%%%%%%
%
% File_Info
%
%%%%%%%%%%%%%%%%
\subsection{File Info}\label{sec:File_Info}
{\bf \# File\_Info } \\
{\it Character} \\ \\
%
This section is used only while generating a fragment library. Cassandra will use the filename
specified in {\it Character} to store different conformations of the fragment being simulated. Once again, this
section is automatically handled by library\_setup.py. However, if the user wishes to modify this part,
use the following template: \\ \\
%
\texttt{
\# File\_Info \\
frag.dat \\ \\}
%
This will tell Cassandra to store the fragment library in the file named \texttt{frag.dat}.
%
%%%%%%%%%%%%%%%%
%
% CBMC_Info
%
%%%%%%%%%%%%%%%%
\subsection{CBMC parameters}\label{sec:CBMC_Info}
{\bf \# CBMC\_Info} \\
{\tt kappa\_ins} {\it Integer(1)} \\
{\tt kappa\_dih} {\it Integer(2)} \\
{\tt rcut\_cbmc} {\it Real(3,1)} [{\it Real(3,2)}] \\ \\
%
Cassandra utilizes a configurational bias methodology based on sampling a library of fragment conformations \cite{Shah:2011}.
This section sets a number of parameters required for biased insertion/deletion (refer to the sections
\# Prob\_Insertion, \# Prob\_Deletion and \# Prob\_Swap) and configurational
regrowth (\# Prob\_Regrowth section) of molecules.
This section is only required if molecules are regrown, inserted and/or deleted. \\ \\
%
Keyword {\tt kappa\_ins} is required
if the section {\tt \# Start\_Type} is given with keyword {\tt make\_config} or {\tt add\_to\_config}, or
if the section {\tt \# Sim\_Type} is {\tt gcmc}, {\tt gemc} or {\tt gemc\_npt}.
For a biased insertion, a fragment is chosen to insert first in proportion to the number of atoms in fragment.
For example, to insert a united-atom molecule of ethylbenzene,
the ring fragment has 7 pseudoatoms while the other has 3.
The ring fragment will be inserted first with a probability of 0.7.
By contrast, to insert a united-atom molecule of dodecane,
all ten fragments have 3 pseudoatoms and so one is chosen with uniform probability.
After choosing a Boltzmann-distributed conformation and an orientation with uniform probability,
{\it Integer(1)} trial positions are generated for the center-of-mass of the fragment.
One of the trial positions is then selected randomly based on the Boltzmann weight of the energy of the trial position. \\ \\
%
%Once a trial position for the insertion is chosen, rotational bias may be applied by generating a number
%of trial orientations. {\it Integer(2)} specifies the number of such trial orientations. This feature will be
%implemented in later versions of Cassandra and any value for {\it Integer(2)}, at present, is ignored.
%To avoid any confusion, {\it Integer(2)} is set to 0. \\ \\
%
Keyword {\tt kappa\_dih} is required
if any species composed of multiple fragments is inserted/deleted or regrown.
Additional fragments are added to the growing molecule
using {\it Integer(2)} trial dihedral angles that connect the new fragment to the existing part of molecule. \\ \\
%
Keyword {\tt rcut\_cbmc} is required if section {\tt \# CBMC\_Info} is required.
For all the trials, energy of the partially grown molecule with itself and surrounding molecules is to be calculated.
For this purpose, a short cutoff is used. {\it Real(3,i)} specifies the cutoff distance in \AA\ for box $i$.
A short cutoff is fast, but might miss some overlaps. You can experiment with this value to optimize it for your system.\\ \\
%
For a GEMC simulation in which 12 candidate positions are generated for biased insertion/deletion, 10 trials for
biased dihedral angle selection and the cutoff for biasing energy calculation is set to 5.0 \AA\ in box 1 and 6.5 \AA\
in box 2, this section would look like: \\ \\
%
\texttt{
\# CBMC\_Info \\
kappa\_ins   12 \\
kappa\_dih   10 \\
rcut\_cbmc   5.0 6.5}
%
%
%%%%%%%%%%%%%%%%%
%%
%% Bias_Info
%%
%%%%%%%%%%%%%%%%%
%\subsection{Preferential Bias}\label{sec:Bias_Info}
%{\bf \# Bias\_Info} \\
%{\it Real(1) Real(2) } \\ \\
%%
%{\it Real(1)} is the radius of a sphere around each fractional particle. The molecules
%in this sphere will be preferentially selected for translation, rotation and regrowth.
%{\it Real(2)} is the probability of moving a molecule outside the sphere defined by
%{\it Real(1)}. \\ \\
%
%%
%%%%%%%%%%%%%%%%%
%%
%% Number of ideal gas particles
%%
%%%%%%%%%%%%%%%%
%\subsection{Number of ideal gas particles}\label{sec:IGAS_Num}
%{\bf \# IGAS\_Num} \\
%{\it Integer(1)} \\ \\
%{\it Integer(1)} specifies the number of ideal gas particles. This is
%used when a Gibbs ensemble simulation is carried out with three boxes
%such that an intermediate box is used to facilitate transfer between
%two dense phases. The intermediate box wil contain {\it Integer(1)}
%ideal gas particles. \\ \\
%%
%%%%%%%%%%%%%%%%%
%%
%% Solid Potential Type
%%
%%%%%%%%%%%%%%%%
%%
%\subsection{Solid Potential Type}\label{sec:Solid_Potential_Type}
%%
%{\bf \# Solid\_Potential\_Type}
%{\it Character(1)}
%This keyword is required when a simulation box shape is declared as a slit
%pore under '\# Box\_Info' (\autoref{sec:Box_Info}). At this time, only
%Steele potential can be used for slit pore simulation. In this
%instance, {\it Character(1)} is replace by 'Steele'.
%%
%%%%%%%%%%%%%%%%%
%%
%% Pore Width
%%
%%%%%%%%%%%%%%%%
%%
%\subsection{Pore Width}\label{sec:Pore_Width}
%{\bf \# Pore\_Width} \\
%{\it Real(1)} \\ \\
%Sets the pore width ({\it Real(1)} for a box with 'SLIT\_PORE' shape and when Ewald
%summation is enabled. See \autoref{sec:Box_Info}.

%\newpage
%\section{read\_config}
%
%A 'read\_config' file is used to restart a simulation from an equilibrated structure or to continue a run from a previous simulation.
%This file is required for each box when the \texttt{Start\_Type} is set as 'read\_config' in the input control file.
%On the first line of the file are specified total number of molecules of each species in a given box.
%From the second line onwards, the x, y and z coordinates are specified for molecules of each species.
%Usually, this file is obtained from a checkpoint file or the last configuration stored in a movie xyz file.
%A sample 'read\_config' file is shown below.
%
%\newpage
%\section{Checkpoint file}
%A checkpoint file is similar to 'read\_config' file and is used to restart a simulation from an equilibrated structure or
%to continue a run from previous simulation. A key difference between the checkpoint and read\_config file is that
%thermodynamic averages and MC step are not initialized to zero. The checkpoint file produced by a previous simulation
%can be directly used to start another simulation. No separate files for multiple boxes are necessary. A checkpoint file
%contains various information about the state of the system. \\ \\
%In each box, for each species, the following information is printed on each line at the beginning of the file\\
%
%\begin{itemize}
%\item Total number of displacement trials, number of rotation trials, number of dihedral trials and number of angle bending trial.
%\item On the next line the successful attempts for each of the above moves are provided.
%\item The third line lists maximum displacement width, rotation width and dihedral rotation width.
%\item If the simulation involved volume displacement moves that information will also be displayed.
%\item Total number of MC steps will be provided next.
%\item For each of the boxes, the following is displayed on a separate line:
%
%  \begin{itemize}
%       \item Total number of MC moves attempted for each box
%
%       \item Volume of the box
%
%       \item Box shape
%
%       \item The cell matrix of the box
%
%       \item Inverse of the cell matrix.
%
%       \item If the simulation involved volume displacement moves, maximum displacement for the box.
%    \end{itemize}
%\item Random number sequence at the end of the simulation.
%\item If the simulation was a Reactive Monte Carlo with CFC then information about the state of the reaction and the weights for each bin.
%\item Species id and total number of molecules of that species in the simulation.
%\item xyz coordinates of all the molecules present in the simulation, along with the identity of the box a given molecule is in. If it's a CFC simulation then additional information regarding the type of the molecule (integer or
%fractional) along with the scaling parameter is displayed. For a CFC Reactive Monte Carlo simulation, molecule type, index of the fraction and reaction number are output.
%\end{itemize}
%\newpage
%
%%%%%%%%%%%%%%%%
%
% L_Coul_CBMC
%
%%%%%%%%%%%%%%%
%
%\subsection{Flag for Coulombic Biasing}\label{sec:Get_L_Coul_CBMC}
%
%{\bf \# L\_Coul\_CBMC} \\
%{\it Logical(1)} \\ \\
%
%The keyword sets if, during biased insertion/deletion or regrowth,
%Coulombic energy is to be used. Acceptable values for {\it Logical(1)}
%are '.true.', '.TRUE.', '.false' or '.FALSE.'. If the keyword is not
%specified in the MCF, the default value is '.TRUE.' \\ \\
%
%For example, to turn off the Coulombic energy calculations during biasing,
%you would specify the following: \\ \\
%
%\texttt{
%\# L\_Coul\_CBMC \\
%.FALSE. }
%
%%%%%%%%%%%%%%%%
%
% Get_Species_Type
%
%%%%%%%%%%%%%%%
%
%\subsection{Species Type}\label{sec:Get_Species_Type}
%
%{\bf \# Species\_Type} \\
%{\it Character(1)} \\ \\
%
%The keyword describes whether a given species is a 'EXCHANGABLE' and hence
%insertion/deletion or swap moves will be carried out for this
%species. If this keyword is not specified, the default is 'NORMAL' for the
%species type and no attempts to insert/delete/swap the molecules of
%this species will be made during the course of a simulation. \\ \\
%
%%%%%%%%%%%%%%%%
%
% Get_Insertion_Style
%
%%%%%%%%%%%%%%%
%
%\subsection{Insertion Style}\label{sec:Get_Insertion_Style}
%
%{\bf \# 1st\_Fragment\_Ins\_Style} \\
%{\it Character(1)} \\ \\
%
%This keyword is a required keyword in MCF. It sets whether the
%first fragment is placed based on its center-of-mass or using an atom
%of a fragment. Acceptable keywords are 'COM', 'com', 'BEAD' and
%'bead'. For non-ring fragments, COM-based insertion is preferred while
%for ring fragments it may be advantageous to place an atom via 'BEAD'
%or 'bead' option before the entire ring is placed. The `BEAD' or `bead' option
%will be made available in later versions of Cassandra. Thus, this section
%appears in the MCF as follows: \\ \\
%
%\texttt{
%\# 1st\_Fragment\_Ins\_Style \\
%COM}
%
%Make sure that if the insertion style is set to 'BEAD' or 'bead', the variable kappa\_rot is set to a non-zero number in CBMC\_Info so that rotational bias is carried out while placing the fragment. \\ \\

\section{Molecular Connectivity File}\label{sec:MCF_File}
%
A Molecular Connectivity File (MCF) defines the information related to bonds, angles, dihedrals, impropers
fragments and non bonded interactions for a given species. One MCF is required for each species present in
the system. The information contained in this file involves the force field parameters, atoms
participating in each of the interactions and the functional form used in each potential contribution.
The keywords are preceeded by a `\#' and comments follow a `!'. Similarly to the input file, the order
of the keywords is not important. A complete list of the keywords is provided below. \\ \\
%
{\bf Note that parameters for all of the following keywords must be separated by spaces only.
Do not use the tab character. \\ \\
%
Note that MCFs are generated by the script mcfgen.py automatically. The following description is provided for
the users who wish to modify the MCF or manually write the MCF.} \\ \\
%
%%%%%%%%%%%%%%%%
%
% Atom Info
%
%%%%%%%%%%%%%%%
%
\subsection{Atom Info}\label{sec:Get_Atom_Info}
%
{\bf \# Atom\_Info} \\
{\it Integer(1)} \\
{\it Integer(2)   Character(3)*20  Character(4)*6   Real(5)   Real(6)
  Character(7)*20     Optional\_Parms  Character(fin)} \\ \\
%
This keyword specifies the information for non-bonded interactions.
It is a required keyword in the MCF. If not specified, the code will abort. The inputs are specified below:
%
%\noindent
\begin{itemize}
%\setlength{\itemindent}{-0.25in}
%
\item {\it Integer(1)}: Total number of atoms in the species.
%
\item {\it Integer(2)}: Atom index.
%
\item {\it Character(3)*20}: Atom type up to 20 characters. This string of characters should be
unique for each interaction site in the system, i.e. do not use the same atom type
for two atoms in the same (or different) species unless the (pseudo)atoms have the same atom types.
%
\item {\it Character(4)*6}: Atom element name up to 6 characters.
%
\item {\it Real(5)}: Mass of the atom in amu. Note that for united atom models, this would be the
mass of the entire pseudoatom.
%
\item {\it Real(6)}: Charge on the atom.
%
\item {\it Character(7)}: The functional form for van der Waals (vdW) interactions.
Options are "LJ" for Lennard-Jones, "Mie" for the Mie potential,
or "NONE" if the atom type does not have vdW interactions.
"LJ" and "Mie" cannot be used in the same simulation.
This must match what is given for \texttt{\# VDW\_Style}
(subsection \ref{sec:VDW_Style}) in the input file.

\item {\it Character(fin)}: The final entry on the line is `ring' only if the atom is part
of a ring. For atoms that are not part of rings, leave this field blank. Note that the ring
fragments contain all ring atoms (e.g., in cyclohexane, all six carbons),
and any atoms bonded directly to the ring (e.g., in cyclohexane, all the hydrogens).
However, the `ring' entry is ONLY appended for those atoms that belong to the ring 
(e.g., for cyclohexane, only the carbon atoms would have `ring' appended).
\end{itemize}
Additional parameters are required for LJ and Mie potentials. For LJ,
%
\begin{itemize}
\item {\it Real(8)}: The energy parameter in K.
%
\item {\it Real(9)}: Collision diameter ($\sigma$)  in \AA.
\end{itemize}
%
For Mie,

\begin{itemize}
\item {\it Real(8)}: The energy parameter in K.
%
\item {\it Real(9)}: Collision diameter ($\sigma$)  in \AA.
%
\item {\it Real(10)}: The repulsive exponent.
%
\item {\it Real(11)}: The dispersive exponent.
\end{itemize}
%
%
{\bf Note that for species with a single fragment, the branch point atom
 is listed as the first atom.} \\ \\
%
For example, for a united atom pentane model: \\ \\
%
\texttt{
\# Atom\_Info\\
5\\
1    CH3\_s1    C    15.0107    0.0    LJ    98.0    3.75\\
2    CH2\_s1    C    14.0107    0.0    LJ    46.0    3.95\\
3    CH2\_s1    C    14.0107    0.0    LJ    46.0    3.95\\
4    CH2\_s1    C    14.0107    0.0    LJ    46.0    3.95\\
5    CH3\_s1    C    15.0107    0.0    LJ    98.0    3.75\\
} \\
%
The number below the keyword \texttt{\# Atom\_Info} specifies a species with 5 interaction sites, consistent with a united atom pentane model.
The first column specifies the atom ID of each of the pseudo atoms.
The second and third columns provide the atom type and atom name, respectively.
The fourth column represents the atomic mass of each pseudoatom. Note that the mass of
CH3\_s1 is 15.0107 for this united atom model, as it involves a carbon and three hydrogen atoms.
The same applies for all other interaction sites.
The fifth column contains the partial charges placed on each of these pseudoatoms.
The sixth, seventh and eighth columns contain the repulsion-dispersion functional form,
the energy parameter and the collision diameter respectively.
In this case, the usual Lennard-Jones functional form is used.
Note that none of these atoms used the flag `ring', as no rings
are present in this molecule. \\ \\
%
For a molecule containing rings, for example cyclohexane: \\ \\
%
\texttt{
\# Atom\_Info \\
6\\
1    CH\_s1    C    13.0107    0.0    LJ    52.5    3.91 ring\\
2    CH\_s1    C    13.0107    0.0    LJ    52.5    3.91 ring\\
3    CH\_s1    C    13.0107    0.0    LJ    52.5    3.91 ring\\
4    CH\_s1    C    13.0107    0.0    LJ    52.5    3.91 ring\\
5    CH\_s1    C    13.0107    0.0    LJ    52.5    3.91 ring\\
6    CH\_s1    C    13.0107    0.0    LJ    52.5    3.91 ring\\
}
\\
%
Note the flag `ring' was appended as the last column for this cyclic molecule. \\ \\
%
For the SPC/E water model:  \\ \\
%
\texttt{
\# Atom\_Info\\
3\\
1    O1\_s1    O    16.00     -0.8476    LJ    78.20   3.1656\\
2    H2\_s1    H    1.000      0.4238    NONE\\
3    H3\_s1    H    1.000      0.4238    NONE\\
} \\
%
This is a molecule with a single fragment, so the branch point atom is the first atom in the list.

For a single-site model of CO2 using the Mie potential:
\\
\texttt{
\# Atom\_Info\\
1\\
1    CO2       C    44.00      0.0       Mie  361.69   3.741   23.0   6.66\\
} \\
where the last two parameters are the repulsive and dispersive exponents, respectively.

\subsection{Bond Info}\label{sec:Get_Bond_Info}
%
{\bf \# Bond\_Info} \\
{\it Integer(1)} \\
{\it Integer(i,2) Integer(i,3) Integer(i,4) Character(i,5) Real(i,6) Optional\_Parms Real(i,7)} \\
\\
This section provides information on the number of bonds in a molecule
and atoms involved in each bond along with its type.  It is a required keyword in the MCF.
If not specified, the code will abort. The inputs are specified below: \\
%
\begin{itemize}

\item {\it Integer(1)}: Total number of bonds in the species. From the
next line onwards, the bonds are listed sequentially and information
for each bond is included on a separate line.
%
\item {\it Integer(i,2)}:  Index of the $i^{th}$ bond.
%
\item {\it Integer(i,3) Integer(i,4)}: IDs of the atoms participating in
the bond.
%
\item {\it Character(i,5)}: Type of the bond. At present only
`fixed' is  permitted.
\item {\it Real(i,6)}: Specifies the bond length for a particular bond in \AA.
\item {\it Real(i,7), Optional}: Specify the allowable deviation from
the bond length. Default value is 0.01 \AA.

\end{itemize}
%
{\bf Note that at present, Cassandra simulations can be carried out
  only for fixed bond length systems.} \\ \\
%
For example, for the water model SPC/E, the \texttt{\# Bond\_Info} section is the following: \\ \\
%
\texttt{
\# Bond\_Info \\
2 \\
1    1    2    fixed     1.0 \\
2    1    3    fixed     1.0 \\
} \\
%
In the above example, two bonds are specified whose fixed length is set to 1.0 \AA.

\subsection{Angle Info}\label{sec:Get_Angle_Info}
%
{\bf \# Angle\_Info} \\
%
{\it Integer(1)} \\
%
{\it Integer(i,2) Integer(i,3) Integer(i,4) Integer(i,5)
  Character(i,6) Real(i,7) Real(i,8)} \\ \\
%
The section lists the information on the angles in the species.
It is a required keyword in the MCF. If not specified, the code
will abort. \\
%
\begin{itemize}
\item {\it Integer(1)}: Number of angles in the species.
%
\item {\it Integer(i,2)}: Index of the $i^{th}$ angle.
%
\item {\it Integer(i,3) Integer(i,4) Integer(i,5)}: IDs of the atoms
participating in the $i^{th}$ angle. Note that {\it Integer(i,4)} is
the ID of the central atom.
%
\item {\it Character(i,6)}: Type of the angle. Currently,
Cassandra supports `fixed' and `harmonic' (Eq. section~\ref{Eq:angle_potential})
angles. For the `fixed' option, {\it Real(i,7)} is the value of the
angle and {\it Real(i,8)} is ignored by the code if specified. In the
case of 'harmonic' potential type, {\it Real(i,7)} specifies the
harmonic force constant ($K/rad^2$) while {\it Real(i,8)} is the nominal bond
angle (in degrees).

\end{itemize}
For example, for a united atom pentane molecule with flexible angles, this section is the following: \\ \\
%
\texttt{
\# Angle\_Info \\
3 \\
1    1    2    3    harmonic     31250.0    114.0\\
2    2    3    4    harmonic     31250.0    114.0\\
3    3    4    5    harmonic     31250.0    114.0\\
} \\
%
In the above example, the three angles between the pseudoatoms found in the pentane model are specified.
The three angles have an harmonic potential, whose force constant is equal and is set to 31250.0 K/rad$^2$.
Finally, the equilibrium angle for these angles is 114.0$\degree$. \\ \\
%
An example for SPC/E water model with fixed angles is provided below: \\ \\
%
\texttt{
\# Angle\_Info \\
1 \\
1    2    1    3   fixed  109.47 \\
} \\
This model has only one angle that is set to 109.47$\degree$. Note that this angle is fixed, so there is no
force constant.
%
\subsection{Dihedral Info}\label{sec:Get_Dihedral_Info}
%
{\bf \# Dihderal\_Info} \\
%
{\it Integer(1)} \\
%
{\it Integer(i,2) Integer(i,3) Integer(i,4) Integer(i,5) Integer(i,6)
  Character(i,7) Real(i,8) Real(i,9) Real(i,10) Real(i,11)} \\ \\
%
This section of the MCF lists the number of dihedral angles and
associated information for a given species. It is a required keyword in the MCF.
If not specified, the code
will abort.

\begin{itemize}
%
\item {\it Integer(1)}: Lists the number of dihedral angles.
%
\item {\it Integer(i,2)}: Index of the $i^{th}$ dihedral angle.
%
\item {\it Integer(i,3): Integer(i,6)} - IDs of the atoms in the $i^{th}$
dihedral angle.
%
\item {\it Character(i,7) }: Dihedral potential type. Acceptable options
are `OPLS', `CHARMM', `harmonic' and `none'. If `OPLS' dihedral
potential type is selected, then the real numbers {\it Real(i,8) -
  Real(i,11)} are the coefficients in the Fourier series
(see Eq ~\ref{Eq:phi_OPLS}). The units are in kJ/mol. For the `CHARMM'
dihedral potential type, three additional parameters are specified:
$a_0, a_1$ and $\delta$ (section~\ref{Eq:phi_CHARMM}).  If `harmonic' dihedral
potential type is used, then two additional parameters, $K_{phi}$ and
$\phi_0$ (section Eq ~\ref{Eq:phi_harmonic}), are specified.  For the `none' dihedral potential
type, no additional parameters are necessary.

\end{itemize}
%
For example, for a united atom pentane molecule using an OPLS dihedral potential type,
the dihedrals are specified as follows:\\ \\
%
\texttt{
\# Dihedral\_Info\\
2\\
1    1    2    3    4    OPLS     0.0     2.95188     -0.5670     6.5794\\
2    2    3    4    5    OPLS     0.0     2.95188     -0.5670     6.5794\\
}\\
%
In this model two dihedral angles are specified by atoms 1,2,3,4 and 2,3,4,5.
This model uses an OPLS functional form and thus four parameters are provided
after the OPLS flag.
%
\subsection{Intramolecular Scaling}\label{sec:Intra_Scaling}
{\bf \# Intra\_Scaling} \\
{\it Real(i,1) Real(i,2) Real(i,3) Real(i,4)} \\
{\it Real(i,5) Real(i,6) Real(i,7) Real(i,8)} \\ \\
%
This section sets the intramolecular scaling for 1-2, 1-3, 1-4 and 1-N
interactions within a given species. 1-2 means interactions between
atom 1 and another atom 2 directly bonded to it, 1-3 means
interactions between atom 1 and other atoms 3 separated from atom 1 by
exactly two bonds, etc. The first line corresponds to the
VDW scaling: {\it Real(i,1) Real(i,2) Real(i,3) Real(i,4)} apply to
1-2, 1-3, 1-4 and 1-N interactions, where N corresponds to all atoms
separated from atom 1 by more than three bonds.
The second line corresponds to the Coulomb scaling:
{\it Real(i,5)  Real(i,6) Real(i,7) Real(i,8)} apply to 1-2, 1-3, 1-4 and 1-N interactions.
Note that intramolecular scaling applies to all the boxes in the simulation. \\ \\
%
For example, \\ \\
\texttt{
\# Intra\_Scaling \\
0.0 0.0 0.5 1.0 \\
0.0 0.0 0.5 1.0}
\\ \\
would turn off 1-2 and 1-3 interactions, would scale the VDW and
Coulombic interactions for 1-4 atoms by 50\% and would use full
interactions for all other atom pairs in the species. \\ \\
%
If the \# Intra\_Scaling section is missing from the MCF,
it will be looked for in the input file. \\ \\
%
\subsection{Fragment Info}\label{sec:Get_Fragment_Info}
%
{\bf \# Fragment\_Info} \\
%
{\it Integer(1)} \\
%
{\it Integer(i,2) Integer(i,3) Integer(i,4) Integer(i,5)
  ... Integer(i,2+Integer(i,3))} \\ \\
%
This section defines the total number of fragments in a given
species. It is an optional keyword. However, if the species is composed
of fragments, then this section must be specified. The inputs are specified below:
%
\begin{itemize}
\item {\it Integer(1)}: Total number of fragments.
%
\item {\it Integer(i,2)}: Index of the $i^{th}$ fragment.
%
\item {\it Integer(i,3)}: Number of atoms in the $i^{th}$ fragment.
%
\item {\it Integer(i,4) ... Integer(i,2+integer(i,3))}: List of the atom IDs in the fragment.
The first atom ID is that for the branch point atom.
\textbf{Atom ordering for the remaining atoms must match the order of atoms in the fragment library files.}
\end{itemize}
%
For example, for a pentane united atom model:\\ \\
%
\texttt{
\# Fragment\_Info\\
3\\
1    3    2    1    3\\
2    3    3    2    4\\
3    3    4    3    5\\
} \\
%
This specifies three fragments. Each of these fragments has three atoms. The first atom specified
for each of the fragments is the branch point atom.
%
\subsection{Fragment
  Connectivity}\label{sec:Get_Fragment_Connectivity}
%
{\bf \# Fragment\_Connectivity} \\
%
{\it Integer(1)} \\
%
{\it Integer(i,2) Integer(i,3) Integer(i,4)} \\ \\
%
The section lists the fragment connectivity - which fragment is bonded
to which other fragment. It is a required keyword if {\bf
  Fragment\_Info} is specified.
%
\begin{itemize}
\item {\it Integer(1)}: total number of fragment connections.
%
\item {\it Integer(i,2)}: index of the $i^{th}$ fragment connectivity.
%
\item {\it Integer(i,3) Integer(i,4)}: fragment IDs participating in the connectivty.
\end{itemize}
%
For example, for a pentane united atom model: \\ \\
%
\texttt{
\# Fragment\_Connectivity\\
2\\
1    1    2\\
2    2    3\\
} \\
%
In this example, there are three fragments, therefore, two fragment connectivities must be specified. Note that fragment 1 is connected to fragment 2 and fragment 2 is connected to fragment 3.


